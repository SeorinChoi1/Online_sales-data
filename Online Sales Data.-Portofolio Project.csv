-- SQL Portfolio Project: Sales Data Analysis

-- Step 1: Create working table
CREATE TABLE sales_data2 LIKE sales_data;
INSERT INTO sales_data2 SELECT * FROM sales_data;

-- Step 2: Identify and remove duplicates
WITH duplicate_cte AS (
  SELECT *,
         ROW_NUMBER() OVER (
           PARTITION BY `Transaction ID`, `Date`, `Product Category`, `Units Sold`, `Unit price`, `Region`, `Payment Method`
           ORDER BY `Transaction ID`
         ) AS row_num
  FROM sales_data2
)
DELETE FROM sales_data2
WHERE `Transaction ID` IN (
  SELECT `Transaction ID` FROM duplicate_cte WHERE row_num > 1
);

-- Step 3: Standardize text
UPDATE sales_data2
SET `Product Name` = TRIM(`Product Name`);

-- Step 4: Exploratory Analysis
-- [KPI Summary, Revenue by Category, Top Products... full content above]
